<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE>The Glidein Factory Daemon</TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 2.4  (Linux)">
	<META NAME="CREATED" CONTENT="0;0">
	<META NAME="CHANGED" CONTENT="20081007;13265400">
	<META NAME="CHANGEDBY" CONTENT="Igor Sfiligoi">
        <link rel="stylesheet" type="text/css" href="../glideinWMS.css" media="screen, projection" />
</HEAD>
<body lang="en-US" dir="ltr">
    <h1>
        <a href="index.html">Glidein WMS  Manual</a>
        <ul class="main_links">
        <li><a href="http://www.uscms.org/SoftwareComputing/Grid/WMS/glideinWMS/
index.html" class="main_link">Home</a></li>
        <li><a href="http://www.uscms.org/SoftwareComputing/Grid/WMS/glideinWMS/
doc.prd/install/" class="main_link">Installation</a></li>
        <li><a href="http://www.uscms.org/SoftwareComputing/Grid/WMS/glideinWMS/
doc.prd/manual/" class="main_link">Manual</a></li>
        <li><a href="http://www.uscms.org/SoftwareComputing/Grid/WMS/glideinWMS/
download.html" class="main_link">Download</a></li>
        </ul>

    </h1>

    <ul class="components">
        <li> <a href="../index.html"> Overview </a></li>
        <li> <a class="selected" href="index.html"> Factory </a></li>
        <li> <a href="../frontend/index.html"> VO Frontend </a></li>
        <li> <a href="../monitoring.html" class="last">Monitoring</a></li>
    </ul>
    <div class="clear" />
    <ul class="subcomponents">
        <li> <a href="index.html"> Factory </a></li>
        <li> <a class="selected" href="factory_internals.html"> Factory Internals </a></li>
        <li> <a href="entry.html"> Entry </a></li>
        <li> <a href="entry_internals.html"> Entry Internals </a></li>
        <li> <a href="glidein_internals.html"> Glidein Internals </a></li>
        <li> <a href="custom_scripts.html"> Custom Scripts </a></li>
        <li> <a class="last" href="configuration_variables.html"> Configuration </a></li>
    </ul>
    <div class="clear" />


    <ul class="topnav">
        <LI><A HREF="#overview">Overview</A></li>
	<LI><A HREF="#flow">Program flow</A></li>
	<LI><A HREF="#source">Source code distribution</A></li>
	<LI><A HREF="#config">Configuration files</A></li>
    </ul>

<div class="content">
<h2 class="header">Glidein Factory Internals</h2>
<H2>Description</H2>
<P>This document describes the internals of a glideinWMS Factory
Daemon.</P>
<div class="section">
<H2><A NAME="overview"></A>Glidein Factory Overview</H2>
<P>A <A HREF="index.html">Glidein Factory</A> is composed of a
Factory Daemon and several Factory Entry Daemons. Each Entry Daemon
is autonomous; it advertises itself and processes the incoming
requests. The main Factory Daemon just launches and monitors the
Factory Entry Daemons.</p>
<p>
	See the picture below for a logical
overview.
</p>
	<IMG SRC="entry_points_overview.png">
<p>
	All daemons of a Glidein Factory share the same directory tree. The root
of the tree contains the common startup and configuration files,
while each entry point has a few additional configuration files on
its own.</P>
</div>

<div class="section">
<H2><A NAME="flow"></A>Program flow</H2>
<P>The main tasks of the Factory Daemon are the startup up the Entry
Daemons and the aggregation of statistics from the entries.<BR>See
picture below for an overview.</P>
<IMG SRC="flow_factory_main.png">
<p>
	The only non trivial operation in the statistics aggregation. 
The Factory Daemon reads the XML files produced by the Factory Daemons,
aggregates them, and writes out an aggregate XML file. It also
updates the <A HREF="http://oss.oetiker.ch/rrdtool/">RRD</A> files
used to keep the history and creates the rrdtool graphs and HTML
pages for human consumption.<BR>See picture below for an overview.</P>
<IMG SRC="flow_factory_stats.png">
</div>

<div class="section">
<H2><A NAME="source"></A>Source code distribution</H2>
<P>The Factory Daemon is implemented as a series of python scripts,
and it does not need to be pre-compiled.</P>
<P>The code is spread over several python modules, some specific to
the factory other shared between different parts of the glideinWMS.
There are also an external dependency on the <A HREF="http://oss.oetiker.ch/rrdtool/">rrdtool</A>
python libraries.
</p>
<p>The picture below shows the dependency tree.</P>
<P><IMG SRC="modules_factory.png">
</p><p>glideFactory.py
is executable.</P>
<P>The glideinWMS common libraries are in glideinWMS/lib directory.</P>
</div>

<div class="section">
<H2><A NAME="config"></A>Configuration files</H2>
<P>The Factory daemon reads a single configuration file:</p>
	<TT>glidein.descript</TT>
<p>It is located in the root of the factory configuration tree.</P>
<P>Only two elements of this configuration file are used:</P>
<UL>
	<LI><TT>Entries</TT> - The list of entries, used to launch the Entry Daemons.</li>
	<LI><TT>LoopDelay</TT> - How long should it sleep between iterations.</li>
</UL>
<P><B>Warning</B>: The configuration file should never be changed by
hand. It is generated and maintained by 
<A HREF="index.html#create_entry">a dedicated tool.</A></P>
</div></div>
<p> <b>CVSROOT:</b> cvsuser@cdcvs.fnal.gov:/cvs/cd </p>
<p> <b>Packages:</b> glideinWMS </p>
<p> <b>glideinWMS Support:</b> glideinwms-support@fnal.gov</p>

</BODY>
</HTML>
