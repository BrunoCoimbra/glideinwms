<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE>Installation of the glidein pool Collector</TITLE>
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<H1>Installation of
the glidein&nbsp;pool&nbsp;Collector
</H1>
<hr>
<table>
<tr valign="center" align="center">
<td>[</td><td><a href="#description">Description</a></td>
<td>|</td><td><a href="#hardware">Hardware requirements</a></td>
<td>|</td><td><a href="#software">Needed software</a></td>
<td>|</td><td><a href="#condor">Installation instructions</a></td>
<td>]</td>
</tr>
</table>
<hr>
<TABLE CELLPADDING=2 CELLSPACING=2>
	<TR>
		<TD VALIGN=TOP>
	                <a name="description">
			<H2><FONT FACE="Bitstream Vera Serif"><FONT SIZE=4>1. Description </FONT></FONT>
			</H2>
			<P><FONT FACE="Liberation Serif"><FONT SIZE=3>The glidein pool
			Collector node will be the <A HREF="http://www.cs.wisc.edu/condor/manual/v7.0/3_1Introduction.html#SECTION00411000000000000000">Condor
			Central Manager</A> for the glidein pool, i.e. it will run the
			Condor Collector and Negotiator daemons.<BR>These daemons define
			the glidein pool; if this node dies, the pool dies with it.</FONT></FONT></P>
                        <a name="hardware">
			<H2><FONT FACE="Bitstream Vera Serif"><FONT SIZE=4>2. Hardware
			requirements </FONT></FONT>
			</H2>
			<P><FONT FACE="Liberation Serif"><FONT SIZE=3>This machine needs
			<B>one or two fast CPUs</B> (one for the Collector and one for the
			Negotiator) and a moderate amount of <B>memory</B> (<B>1GB</B>
			should be enough for most tasks; really big pools may need
			more).<BR>It must have <B>reliable network</B> connectivity and
			must be <B>on the public internet,</B> with <B>no firewalls</B>;
			all worker nodes will be continuously sending UDP packets to the
			Collector.<BR>The machine must be <B>very stable</B>; if the
			Collector dies, the glidein pool dies with it (There are Condor
			techniques to minimize this damage, but you should still try to
			choose the stablest machine you can afford.)<BR>The <B>disk</B>
			needed is just for Condor binaries and log files (<B>5GB</B>
			should be enough)</FONT></FONT></P>
		</TD>
		<TD>
			<P><IMG SRC="overview_collector.png" NAME="graphics1" ALIGN=BOTTOM BORDER=0>
						</P>
		</TD>
	</TR>
</TABLE>
<a name="software">
<H2><FONT FACE="Bitstream Vera Serif"><FONT SIZE=4>3. Needed software
</FONT></FONT>
</H2>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>Any <A HREF="http://www.cs.wisc.edu/condor/manual/v7.0/1_5Availability.html">Condor-supported
OS</A>.<BR>The <A HREF="http://www.python.org/">Python</A>
interpreter (for the installer, v2.3.4 or above)<BR>The <A HREF="https://twiki.grid.iu.edu/twiki/bin/view/Documentation/WebHome">OSG
client software</A>.<BR>The <A HREF="http://www.cs.wisc.edu/condor/downloads/">Condor
distribution</A>.</FONT></FONT></P>

<p><font face="Liberation Serif"><font size="3"><strong>NOTE:</strong>
<ul>
  <li>Condor version v7.3.1 has a known issue with incorrect return/exit codes of condor_status and condor_q</li>
  <li>If you are using Condor version v7.3.2 disable VOMS checking in condor_config file used by condor daemons other than that used by user schedd. VOMS checking adds unrequired overhead. To do so, set <br>
  USE_VOMS_ATTRIBUTES = False <br>
  or for individual condor daemons like collector<br>
  COLLECTOR.USE_VOMS_ATTRIBUTES = False <br>
  </li>
</ul>
</p>


<a name="condor">
<H2><FONT FACE="Bitstream Vera Serif"><FONT SIZE=4>4. Installation
instructions</FONT></FONT></H2>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>The pool Collector can
be installed either as root or as a non privileged user. Either case,
make sure that the user has access to the needed <A HREF="gsi_config.html">GSI
credentials</A>.<BR>There is no real advantage to install as root, so
non-privileged installation is recommended if installed separately.</FONT></FONT></P>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>The whole process is
managed by a install script described below. You will need to provide
a valid <A HREF="http://www.cs.wisc.edu/condor/downloads/">Condor
tarball</A>, so you may as well download it before starting the
installer.</FONT></FONT></P>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>Move into</FONT></FONT></P>
<BLOCKQUOTE><FONT FACE="Liberation Serif"><FONT SIZE=3>glideinWMS/install</FONT></FONT></BLOCKQUOTE>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>and execute</FONT></FONT></P>
<BLOCKQUOTE><FONT FACE="Liberation Serif"><FONT SIZE=3>./glideinWMS_install</FONT></FONT></BLOCKQUOTE>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>You will be presented
with the service selection screen. Follow the
instructions and install all the software components. Most of the
questions should be fairly straightforward. The part that is not
completely automatic is the configuration of the GSI security; you
will need to provide the DN(s) of the glideins, the DNs of all the
submit machines and the DN of the VO frontend.</FONT></FONT></P>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>Here a possible set of
answers is presented; your setup will probably be slightly different:</FONT></FONT></P>
<PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">
Welcome to the glideinWMS Installation Helper

What do you want to install?
(May select several options at one, using a , separated list)
[1] glideinWMS Schedds and Collector
[2] Glidein Factory
[3] GCB
[4] User Pool Collector
[5] User Schedd
[6] Condor for VO Frontend
[7] VO Frontend
[8] Components
Please select: <b>4</b>

The following profiles will be installed:
[4] User Pool Collector

Installing pool collector

Installing condor


You will now need the Condor tarball
You can find it on http://www.cs.wisc.edu/condor/
Versions v7.2.2 and 7.3.1 have been tested, but you
should always use the latest one

Where do you have the Condor tarball? <b>/home/collector/downloads/condor-7.4.2-linux-x86_64-rhel5-dynamic.tar.gz</b>
Checking...
Seems condor version 7.4.2

Where do you want to install it?: [/home/collector/glidecondor] <b>/home/collector/glidecondor</b>
Directory '/home/collector/glidecondor' does not exist, should I create it?: (y/n) <b>y</b>
Installing condor in '/home/collector/glidecondor'

If something goes wrong with Condor, who should get email about it?: <b>admin@my.org</b>
Extracting from tarball
Running condor_configure
Installing Condor from /home/collector/glidecondor/tar/condor-7.4.2 to /home/collector/glidecondor

Condor has been installed into:
    /home/collector/glidecondor

Configured condor using these configuration files:
  global: /home/collector/glidecondor/etc/condor_config
  local:  /home/collector/glidecondor/condor_local/condor_config.local
You should look inside the installation log for some details about how
Condor was installed.
Created scripts which can be sourced by users to setup their
Condor environment variables.  These are:
   sh: /home/collector/glidecondor/condor.sh
  csh: /home/collector/glidecondor/condor.csh

Do you want to split the config files between condor_config and condor_config.local?: (y/n) [y] <b>y</b>

The Condor config has been put in your login files
Please remember to exit and reenter the terminal after the install

Condor installed

Configuring GSI security

GSI security relies on a list of trusted CAs
Where can I find the directory with the trusted CAs?

Do you want to get it from VDT?: (y/n) <b>y</b>
Do you have already a VDT installation?: (y/n) <b>y</b>
Where is the VDT installed?: <b>/home/collector/vdt</b>
Using VDT installation in /home/collector/vdt

To use the GSI security for Pool Collector, you either need
a valid GSI proxy or a valid x509 certificate and relative key.
Its subject (i.e. DN) will be added as the trusted daemon
in the condor configuration.

Will you be using a proxy or a cert? (proxy/cert) <b>cert</b>
Where is your certificate located?: <b>/home/collector/grid-security/servicecert.pem</b>
Where is your certificate key located?: <b>/home/collector/grid-security/servicekey.pem</b>
My DN = '/DC=org/DC=doegrids/OU=Services/CN=collector/master1.my.org'


You will most probably need other DNs in the condor grid mapfile.
The User Schedd(s) and Glidein startds will connect to
and act as daemons to the Pool Collector. Any other node or process
that needs to talk securely with the Collector (like the
VO Frontend) also needs to be authenticated, but not as
a daemon. Finally, if you expect any processes on this node
to use condor security toward other nodes (e.g. the VO Frontend
talking to the WMS Collector), the remote services will also
need to be authenticated. The subjects (i.e. DNs)
for these services will thus most likely be needed.

Please insert all such DNs, together with a user nickname.
An empty DN entry means you are done.
DN: <B>/DC=org/DC=doegrids/OU=Services/CN=schedd1.my.org</B>
nickname: [condor001] <B>submit</B>
Is this a trusted Condor daemon?: (y/n) <B>y</B>
DN: <B>/DC=org/DC=doegrids/OU=Services/CN=gfactory/gfactory1.my.org</B>
nickname: [condor002] <B>pilot</B>
Is this a trusted Condor daemon?: (y/n) <B>y</B>
DN: <B>/DC=org/DC=doegrids/OU=Services/CN=frontend/frontend1.my.org</B>
nickname: [condor002] <B>frontend</B>
Is this a trusted Condor daemon?: (y/n) <B>n</B>
DN: <I>enter</I>
What name would you like to use for this pool?: [My pool] <B>TestPool</B>
How many slave collectors do you want?: [10] <B>10</B>
</PRE>

<H2><FONT FACE="Bitstream Vera Serif"><FONT SIZE=4>5. To Start/Stop Pool Collector</FONT></FONT></H2>
Setup the environment
<div style=MARGIN-LEFT:40px>
  source /home/collector/condor/condor.sh
</div>
<br>
To start Condor run:<br>
<div style=MARGIN-LEFT:40px>
  /home/condor/sbin/condor_master<br>
</div>
<br>
You should see three processes run as user condor: condor_master,
condor_collector and condor_negotiator.<br>
<br>
The log files can be found in
<span style=FONT-WEIGHT:bold>/home/condor/condor_local/log</span>.<br>
<br>
To stop Condor run:<br>
<div style=MARGIN-LEFT:40px>
  /home/condor/sbin/condor_off -master<br>
</div>
<br>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3><A HREF="index.html">Back
to the index</A></FONT></FONT>
</P>
<hr><P ALIGN=LEFT><b>glideinWMS support:</b> glideinwms-support@fnal.gov</p>
</BODY>
</HTML>
