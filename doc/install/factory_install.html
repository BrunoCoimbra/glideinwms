<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <meta http-equiv="CONTENT-TYPE" content="text/html; charset=UTF-8">
  <title>Installation of the WMS Collector and collocated glidein
  Factory</title>
</head>

<body lang="en-US" dir="ltr">
<h1>Installation of the WMS Collector and collocated glidein Factory </h1>
<hr>

<table>
  <tbody>
    <tr align="center">
      <td>[</td>
      <td><a href="#description">Description</a></td>
      <td>|</td>
      <td><a href="#hardware">Hardware requirements</a></td>
      <td>|</td>
      <td><a href="#software">Needed software</a></td>
      <td>|</td>
      <td><a href="#system">System services</a></td>
      <td>|</td>
      <td><a href="#condor">glideinWMS Collector installation</a></td>
      <td>|</td>
      <td><a href="#factory">Glidein Factory installation</a></td>
      <td>|</td>
      <td><a href="#monitoring">Glidein Factory monitoring</a></td>
      <td>]</td>
    </tr>
  </tbody>
</table>
<hr>

<table cellpadding="2" cellspacing="2">
  <tbody>
    <tr>
      <td valign="top"><h2><a name="description"><font
        face="Bitstream Vera Serif"><font size="4">1. Description
        </font></font> </a></h2>

        <p><font face="Liberation Serif"><font size="3">The glidein Factory
        node will be the <a
        href="http://www.cs.wisc.edu/condor/manual/v7.0/3_1Introduction.html#SECTION00411000000000000000">Condor
        Central Manager</a> for the WMS, i.e. it will run the Condor
        Collector and Negotiator daemons, but it will also act as a <a
        href="http://www.cs.wisc.edu/condor/manual/v7.0/3_1Introduction.html#SECTION00411000000000000000">Condor
        Submit node</a> for the glidein factory, running Condor schedds used
        for Grid submission.</font></font></p>

        <p><font face="Liberation Serif"><font size="3">On top of that, this
        node also hosts the glidein factory daemons. The glidein Factory is
        also responsible for the base configuration of the glideins (although
        part of the configuration comes from the <a
        href="frontend_install.html">VO frontend</a>).</font></font></p>

        <h2><a name="hardware"><font face="Bitstream Vera Serif"><font
        size="4">2. Hardware requirements </font></font> </a></h2>

        <p><font face="Liberation Serif"><font size="3">A small installation
        nees <b>one CPU</b> and a moderate amount of <b>memory</b>
        (<b>1GB</b> should be enough).</font></font></p>

        <p><font face="Liberation Serif"><font size="3">A major installation,
        serving tens of sites and several thousand glideins will require
        <b>several CPUs</b> (recommended <b>4-8</b>: 1 for the Condor damons,
        1-2 for the glidein factory daemons and 2 or more for Condor-G
        schedds) and a reasonable amount of <b>memory</b> (at least
        <b>2GB</b>, <b>4GB</b> for a large installation to provide some disk
        caching).</font></font></p>

        <p><font face="Liberation Serif"><font size="3">The <b>disk</b>
        needed is for binaries, config files, log files and Web monitoring
        data (For just a few sites, <b>10GB</b> could be enough, larger
        installations will need <b>100+GB</b> to maintain a reasonable
        history). Monitoring can be pretty I/O intensive when serving many
        sites, so get the fastest disk you can afford, or consider setting up
        a RAMDISK</font></font></p>

        <p><font face="Liberation Serif"><font size="3">It must must be on
        the <b>public internet</b>, with <b>at least one port open to the
        world</b>; all worker nodes will load data from this node trough
        HTTP.</font></font></p>

<h2><a name="software"><font face="Bitstream Vera Serif"><font size="4">3.
Needed software </font></font> </a></h2>

<p><font face="Liberation Serif"><font size="3">A reasonably recent Linux OS
(RH/SL4 nad RH/SL5 tested at press time).<br>
The <a href="http://www.python.org/">Python</a> interpreter (v2.3.4 or
above)<br>
The perl-Time-HiRes rpm.<br>
The <a
href="https://twiki.grid.iu.edu/twiki/bin/view/Documentation/WebHome">OSG
client software</a>.<br>
A HTTP server, like <a href="http://www.apache.org/">Apache</a> or <a
href="http://www.stllinux.org/meeting_notes/2001/0719/tux/intro.html">TUX</a>.<br>
The <a href="http://www.cs.wisc.edu/condor/downloads/">Condor
distribution</a>.<br>
The <a href="http://oss.oetiker.ch/rrdtool/">RRDTool package</a> (v1.2.18 or
later)<br>
The <a href="http://freshmeat.net/projects/m2crypto">M2Crypto python
library</a> (v0.17 or later)<br>
The <a href="http://sourceforge.net/projects/javascriptrrd/">javascriptRRD</a> package (0.5 or later)<br>
The <a
href="index.html">glideinWMS
software</a>.</font></font></p>
      </td>
      <td valign="top"><p><img src="overview_WMS_factory.png" name="graphics1"
        align="bottom" border="0"> </p>

        <p><img src="overview_glidein.png" name="graphics1b" align="bottom"
        border="0"></p>
      </td>
    </tr>
  </tbody>
</table>

<p><font face="Liberation Serif"><font size="3"><strong>NOTE:</strong>
<ul>
  <li>Condor version v7.3.1 has a known issue with incorrect return/exit codes of condor_status and condor_q</li>
  <li>If you are using Condor version v7.3.2 disable VOMS checking in condor_config file used by condor daemons other than that used by user schedd. VOMS checking adds unrequired overhead. To do so, set <br>
  USE_VOMS_ATTRIBUTES = False <br> 
  or for individual condor daemons like collector<br>
  COLLECTOR.USE_VOMS_ATTRIBUTES = False <br> 
  </li>
</ul>
</p>

<h2><a name="system"><font face="Bitstream Vera Serif"><font size="4">4.
System services</font></font></a></h2>

<h3><a name="system_httpd"><font face="Liberation Serif"><font size="3">4.1
HTTP server</font></font></a></h3>

<p><font face="Liberation Serif"><font size="3">The glidein Factory needs a
HTTP server, like <a href="http://www.apache.org/">Apache</a> or <a
href="http://www.stllinux.org/meeting_notes/2001/0719/tux/intro.html">TUX</a>.
The server should be installed on the same node, but a different node can be
used as long as the web area is writable from this one.</font></font></p>

<p><font face="Liberation Serif"><font size="3">Servers often come
pre-installed with HTTP server software, so if you have one running, just
reuse it.<br>
Else, the installer can help you install one (as root).</font></font></p>

<p><font face="Liberation Serif"><font size="3">To use the installer, move
into</font></font></p>

<blockquote>
  <font face="Liberation Serif"><font
  size="3">glideinWMS/install</font></font></blockquote>

<p><font face="Liberation Serif"><font size="3">and execute</font></font></p>

<blockquote>
  <font face="Liberation Serif"><font
  size="3">./glideinWMS_install</font></font></blockquote>

<p><font face="Liberation Serif"><font size="3">You will be presented with
this screen:</font></font></p>

<blockquote>
  <font face="Liberation Serif"><font size="3">What do you want to
  install?<br>
  (May select several options at one, using a , separated list)<br>
  [1] glideinWMS Collector<br>
  [2] Glidein Factory<br>
  [3] GCB<br>
  [4] pool Collector<br>
  [5] Schedd node<br>
  [6] Condor for VO Frontend<br>
  [7] VO Frontend<br>
  [8] Components</font></font></blockquote>

<p><font face="Liberation Serif"><font size="3">Select
<b>8</b>.</font></font></p>

<p><font face="Liberation Serif"><font size="3">You will be given another
menu:</font></font></p>

<blockquote>
  <font face="Liberation Serif"><font size="3">What do you want to
  install?<br>
  (May select several options at one, using a , separated list)<br>
  [a] OSG VDT client<br>
  [b] Base Condor installation<br>
  [c] Web server<br>
  [d] rrdtool graphics package<br>
  [e] PostgreSQL database<br>
  [f] Quill-specific PostgreSQL database</font></font></blockquote>

<p><font face="Liberation Serif"><font size="3">Select
<b>c</b>.</font></font></p>

<p><font face="Liberation Serif"><font size="3">Now follow the instructions.
Most of the questions should be fairly straightforward.</font></font></p>

<h3><a name="system_rrdtool"><font face="Liberation Serif"><font size="3">4.2
RRDTool</font></font></a></h3>

<p><font face="Liberation Serif"><font size="3">You will also need the python
module for <a href="http://oss.oetiker.ch/rrdtool/">RRDTool</a> (v1.2.18 or
later). Many systems come with packages for it; if possible use
that.</font></font></p>

<p><font face="Liberation Serif"><font size="3">RPMs for Redhat/Scientific
Linux distributions can be found at</font></font></p>

<p><a href="http://dag.wieers.com/rpm/packages/rrdtool/"><font
face="Liberation Serif"><font
size="3">http://dag.wieers.com/rpm/packages/rrdtool/</font></font></a></p>

<p><font face="Liberation Serif"><font size="3">Install python-rrdtool*.rpm
and related dependencies.</font></font></p>

<p><font face="Liberation Serif"><font size="3">If installing as root is not
an option, you can build from the sources, as the </font></font><font
face="Liberation Serif"><font size="3"><b>glidein factory</b></font></font>
<font face="Liberation Serif"><font size="3">user, and put the python
libraries into the PYTHON_PATH.<br>
The source code can be downloaded from:<br>
<a
href="http://oss.oetiker.ch/rrdtool/pub/">http://oss.oetiker.ch/rrdtool/pub/</a></font></font></p>

<p><font face="Liberation Serif"><font size="3">Beware: The build process has
several dependencies that make it complicated. Use this option only if you
cannot install from RPMs (or similar). </font></font> </p>

<h3><a name="system_m2crypto"><font face="Liberation Serif"><font
size="3">4.3 M2Crypto</font></font></a></h3>

<p><font face="Liberation Serif"><font size="3">You will need the <a
href="http://freshmeat.net/projects/m2crypto">M2Crypto python library</a>. A
few systems include it in the software distribution; if possible install the
system one.</font></font></p>

<p><font face="Liberation Serif"><font size="3">If your system does not come
with m2crypto package, or you do not can/want install it as root, compile it
from source as the </font></font><font face="Liberation Serif"><font
size="3"><b>glidein factory</b></font></font> <font
face="Liberation Serif"><font size="3">user.<br>
The source code can be downloaded from:<br>
<a
href="http://chandlerproject.org/Projects/MeTooCrypto#Downloads">http://chandlerproject.org/Projects/MeTooCrypto#Downloads</a></font></font></p>

<p><font face="Liberation Serif"><font size="3">The build process is very
easy:</font></font></p>

<blockquote>
  <font face="Liberation Serif"><font size="3">python setup.py build<br>
  python setup.py install --root <i>&lt;base
dir&gt;</i></font></font></blockquote>

<p><font face="Liberation Serif"><font size="3">Finally add M2Crypto
site-packages into the PYTHONPATH, possibly in the .profile, .bashrc and/or
in the .cshrc.<br>
The exact path is system specific. On a 32bit system with python 2.3.x it
will look like this:</font></font></p>

<blockquote>
  <font face="Liberation Serif"><font size="3">export
  PYTHONPATH=$PYTHONPATH:<i>&lt;base
  dir&gt;</i>/usr/lib/python2.3/site-packages/</font></font></blockquote>

<h3><a name="system_javascriptRRD"><font face="Liberation Serif"><font
size="3">4.4 javascriptRRD</font></font></a></h3>

<p><font face="Liberation Serif"><font size="3">You will need the <a
href="http://sourceforge.net/projects/javascriptrrd/">javascriptRRD package</a>. 
It contains the javascript libraries needed by the monitoring.</font></font></p>

<p><font face="Liberation Serif"><font size="3">Just download the tarball,
and untar it. You will need to point the installer to this directory.</font></font></p>


<h2><a name="condor"><font face="Bitstream Vera Serif"><font size="4">5.
glideinWMS Collector installation guide</font></font></a></h2>

<p><font face="Liberation Serif"><font size="3">The glideinWMS Collector can
be installed either as root or as a non privileged user. There is no real
advantage to install as root, so non-privileged installation is
recommended.<br>
Either case, the Collector needs access to <a href="gsi_config.html">GSI
credentials</a>. The recommended setup shares the credentials with the
glidein factory (see below).</font></font></p>

<p><font face="Liberation Serif"><font size="3">The whole process is managed
by a install script described below. You will need to provide a valid <a
href="http://www.cs.wisc.edu/condor/downloads/">Condor tarball</a>, so you
may as well download it before starting the installer.</font></font></p>

<p><font face="Liberation Serif"><font size="3">Move into</font></font></p>

<blockquote>
  <font face="Liberation Serif"><font
  size="3">glideinWMS/install</font></font></blockquote>

<p><font face="Liberation Serif"><font size="3">and execute</font></font></p>

<blockquote>
  <font face="Liberation Serif"><font
  size="3">./glideinWMS_install</font></font></blockquote>

<p><font face="Liberation Serif"><font size="3">You will be presented with
the service selection screen. Follow the instructions
and install all the software components. Most of the questions should be
fairly straightforward. The part that is not completely automatic is the
configuration of the GSI security; you will need to provide the DN of the
glidein factory (if different from the collector one) and the DN of the VO
frontend.</font></font></p>
<p><font face="Liberation Serif" size="3">If you are installing privilage separation, you need to install glideinWMS Schedds and Collector as root</font></p>
<p><font face="Liberation Serif"><font size="3">Here a possible set of
answers is presented; your setup will probably be slightly
different:</font></font></p>
<pre style="margin-left: 0.39in; margin-right: 0.39in; margin-bottom: 0.2in">
Welcome to the glideinWMS Installation Helper

What do you want to install?
(May select several options at one, using a , separated list)
[1] glideinWMS Schedds and Collector
[2] Glidein Factory
[3] GCB
[4] User Pool Collector
[5] User Schedd
[6] Condor for VO Frontend
[7] VO Frontend
[8] Components
Please select: <b>1</b>

The following profiles will be installed:
[1] glideinWMS Schedds and Collector

Installing WMS Schedds and Collector

Installing condor

Which user should Condor run under?: [condor] <b>gfactory</b>

You will now need the Condor tarball
You can find it on http://www.cs.wisc.edu/condor/
Versions v7.2.2 and 7.3.1 have been tested, but you
should always use the latest one

Where do you have the Condor tarball? <b>/home/gfactory/downloads/condor-7.4.2-linux-x86_64-rhel5-dynamic.tar.gz</b>
Checking...
Seems condor version 7.4.2

Where do you want to install it?: [/opt/glidecondor] /home/gfactory/glidecondor
Directory '/home/gfactory/glidecondor' does not exist, should I create it?: (y/n) <b>y</b>
Installing condor in '/home/gfactory/glidecondor'

If something goes wrong with Condor, who should get email about it?: <b>admin@my.org</b>
Extracting from tarball
Running condor_configure
Installing Condor from /home/gfactory/glidecondor/tar/condor-7.4.2 to /home/gfactory/glidecondor

Condor has been installed into:
    /home/gfactory/glidecondor

Configured condor using these configuration files:
  global: /home/gfactory/glidecondor/etc/condor_config
  local:  /home/gfactory/glidecondor/condor_local/condor_config.local
You should look inside the installation log for some details about how
Condor was installed.
Created scripts which can be sourced by users to setup their
Condor environment variables.  These are:
   sh: /home/gfactory/glidecondor/condor.sh
  csh: /home/gfactory/glidecondor/condor.csh

Do you want to split the config files between condor_config and condor_config.local?: (y/n) [y] <b>y</b>
Condor installed

Privilege separation is needed to securely support multiple frontends.
Do you want to install it?: (y/n) [y]<b>y</b>
A privsep config (/etc/condor/privsep_config) is already in place. Do you want to recreate it?: (y/n) <b>y</b>
What is the factory username: <b>gfactory</b>

List the usernames the factroy will use
to separate frontends from one another.
An empty username entry means you are done.
Username: <b>frontenduser1</b>
Username: <b>frontenduser2</b>
Username:

Directories needed by the factory will be given special
treatment to ease administration.
Where will the factory store its config files?[/var/gfactory/glideinsubmit] <b>/home/gfactory/glideinsubmit</b>
Directory '/home/gfactory/glideinsubmit' does not exist, should I create it?: (y/n) <b>y</b>
Where will the factory store its log files?[/var/gfactory/glideinlogs] <b>/var/gfactory/glideinlogs</b>
Where will the factory store the client log files?[/var/gfactory/clientlogs] <b>/var/gfactory/clientlogs</b>
Directory '/var/gfactory/clientlogs' does not exist, should I create it?: (y/n) <b>y</b>
Where will the factory store the client proxies?[/var/gfactory/clientproxies] <b>/var/gfactory/clientproxies</b>
Directory '/var/gfactory/clientproxies' does not exist, should I create it?: (y/n) <b>y</b>

Privilege separation setup completed

Configuring GSI security

GSI security relies on a list of trusted CAs
Where can I find the directory with the trusted CAs?

Do you want to get it from VDT?: (y/n) <b>y</b>
Do you have already a VDT installation?: (y/n) <b>y</b>
Where is the VDT installed?: <b>/home/gfactory/vdt</b>
Using VDT installation in <b>/home/gfactory/vdt</b>

To use the GSI security for WMS Collector, you either need
a valid GSI proxy or a valid x509 certificate and relative key.
Its subject (i.e. DN) will be added as the trusted daemon
in the condor configuration.

Will you be using a proxy or a cert? (proxy/cert) <b>proxy</b>
Where is your proxy located?: <b>/home/condor/security/grid_proxy.wmspool</b>
My DN = '/DC=org/DC=doegrids/OU=Service/CN=gfactory/gfactory1.my.org'


You will most probably need other DNs in the condor grid mapfile.
The VO Frontend(s) will be contacting the WMS Collector
and will interact as daemons. Their subjects (i.e. DNs)
will most likely be needed.

Please insert all such DNs, together with a user nickname.
An empty DN entry means you are done.
DN: <b>/DC=org/DC=doegrids/OU=Services/CN=frontend1.my.org</b>
nickname: [condor001] <b>vofrontend1</b>
Is this a trusted Condor daemon?: (y/n) <b>y</b>
DN: <b>/DC=org/DC=doegrids/OU=Services/CN=frontend2.my.org</b>
nickname: [condor002] <b>vofrontend2</b>
Is this a trusted Condor daemon?: (y/n) <b>y</b>
DN:
What name would you like to use for this pool?: [My glideinWMS pool] <b>GlideinWMSPool</b>
What port should the collector be running?: [9618] <b>9618</b>
How many secondary schedds do you want?: [9] <b>9</b>
[...]
</pre>

<p style="margin-right: 0.39in">The installer will also start the Condor
daemons.<font face="Liberation Serif"><font size="3">To stop the Condor
daemons, issue</font></font></p>

<blockquote>
  <font face="Liberation Serif"><font size="3">killall
  condor_master</font></font></blockquote>

<p><font face="Liberation Serif"><font size="3">To start them
again:</font></font></p>

<blockquote>
  <font face="Liberation Serif"><font size="3">cd &lt;install dir&gt;;
  ./start_condor.sh</font></font>
</blockquote>

<h2><a name="factory"><font face="Bitstream Vera Serif"><font size="4">6.
Glidein Factory installation guide</font></font> </a></h2>

<p><font face="Liberation Serif"><font size="3">The glidein Factory needs a
x509 proxy to communicate with the rest of the world. You need to create such
proxy before instantiating a glidein Factory and then keep it valid for the
life of the factory. If used for job submission (i.e. if the VO Frontends do
not pass their own proxy), this proxy must at any point in time have a
validity of at least the longest expected job being run by the glideinWMS
(and not less than 12 hours).<br>
How you keep this proxy valid (via MyProxy, kx509, voms-proxy-init from a
local certificate, scp from other nodes, or other methods), is beyond the
scope of this document.</font></font></p>

<p><font face="Liberation Serif"><font size="3">The glidein factory itself
should be installed as a non privileged user. The provided installer can be
used to create the configuration file, although some manual tunning will
probably be needed.</font></font></p>

<p><font face="Liberation Serif"><font size="3">Move into</font></font></p>

<blockquote>
  <font face="Liberation Serif"><font
  size="3">glideinWMS/install</font></font></blockquote>

<p><font face="Liberation Serif"><font size="3">and execute</font></font></p>

<blockquote>
  <font face="Liberation Serif"><font
  size="3">./glideinWMS_install</font></font></blockquote>

<p><font face="Liberation Serif"><font size="3">You will be presented with
the service selection screen. Follow the instructions
and install all the software components. Most of the questions should be
fairly straightforward. The part that is not completely automatic is the list
of GCBs and the configuration of the GSI security; you will need to provide
the DNs of all the submit nodes. It is strongly recommended to use CCB over GCB if possible.</font></font></p>

<p><font face="Liberation Serif"><font size="3">Here a possible set of
answers is presented; your setup will probably be slightly
different:</font></font></p>
<pre style="margin-left: 0.39in; margin-right: 0.39in; margin-bottom: 0.2in">
Welcome to the glideinWMS Installation Helper

What do you want to install?
(May select several options at one, using a , separated list)
[1] glideinWMS Schedds and Collector
[2] Glidein Factory
[3] GCB
[4] User Pool Collector
[5] User Schedd
[6] Condor for VO Frontend
[7] VO Frontend
[8] Components
Please select: <b>2</b>

The following profiles will be installed:
[2] Glidein Factory


Installing Glidein Factory

Do you have already a javascriptRRD installation?: (y/n) <b>y</b>
Where is javascriptRRD installed?: <b>/home/gfactory/javascriptrrd-0.5.0</b>
The Glidein Factory can be configured to use a default GSI proxy for submission.

However, this operation mode is not recommended.

Do you want to use such a proxy?: (y/n) [n] <b>n</b>

As you probably know, privilege separation
is needed to securely support multiple frontends.
If you are using privilege separation, the factory directories
must be world readable (except for the proxies dirs)

Hosting the config and log files in the factory home directory
is thus not recommended anymore.

Where will you host your config files?: [/var/gfactory/glideinsubmit] <b>/home/gfactory/glideinsubmit</b>
Where will you host your log files?: [/var/gfactory/glideinlogs] <b>/var/gfactory/glideinlogs</b>
Where will you host the client log files?: [/var/gfactory/clientlogs] <b>/var/gfactory/clientlogs</b>
Where will you host the client proxies files?: [/var/gfactory/clientproxies]<b>/var/gfactory/clientproxies</b>
Where will the web data be hosted?: [/var/www/html/glidefactory] <b>/var/www/html/glidefactory</b>
Directory '/var/www/html/glidefactory' not empty.
Should I use it anyhow?: (y/n) <b>y</b>
What Web URL will you use?: [http://gfactory1.my.org/glidefactory/] <b>http://gfactory1.my.org/glidefactory</b>
Give a name to this Glidein Factory?: [mySites-gfactory1] <b>GlideinFactory-gfactory1</b>
Give a name to this Glidein instance?: [v1_0] <b>v1_0</b>
What is the Condor base directory?: [/home/gfactory/glidecondor]<b>/home/gfactory/glidecondor</b>
The following glidein schedds have been found:
 [1] schedd_glideins1@gfactory1.my.org
 [2] schedd_glideins2@gfactory1.my.org
 [3] schedd_glideins3@gfactory1.my.org
 [4] schedd_glideins4@gfactory1.my.org
 [5] schedd_glideins5@gfactory1.my.org
 [5] schedd_glideins6@gfactory1.my.org
 [5] schedd_glideins7@gfactory1.my.org
 [5] schedd_glideins8@gfactory1.my.org
 [5] schedd_glideins9@gfactory1.my.org
Do you want to use all of them?: (y/n) <b>y</b>
Using ['schedd_glideins1@gfactory1.my.org', 'schedd_glideins2@gfactory1.my.org', 'schedd_glideins3@gfactory1.my.org', 'schedd_glideins4@gfactory1.my.org', 'schedd_glideins5@gfactory1.my.org', 'schedd_glideins6@gfactory1.my.org', 'schedd_glideins7@gfactory1.my.org', 'schedd_glideins8@gfactory1.my.org', 'schedd_glideins9@gfactory1.my.org']

Do you want to use CCB (requires Condor 7.3.0 or better)?: (y/n) <b>y</b>
Do you want to use gLExec?: (y/n) <b>y</b>
Do you want to fetch entries from RESS?: (y/n) [n] <b>y</b>
Which RESS server should I use?: [osg-ress-1.fnal.gov] <b>osg-ress-1.fnal.gov</b>
Select Condor RESS constraint: [] <b>StringlistMember("VO:MyVO",GlueCEAccessControlBaseRule)</b>
Define a python filter: [(int(GlueCEPolicyMaxCPUTime)==0) or (int(GlueCEPolicyMaxCPUTime)>(72*60))] <b>(int(GlueCEPolicyMaxCPUTime)>(1))</b>
Found 28 additional entries
Do you want to use them all?: (y/n) <b>y</b>
Do you want to fetch entries from BDII?: (y/n) [n]<b>n</b>
Please list all additional glidein entry points,

Entry name (leave empty when finished):
Should glideins use the more efficient Match authentication (works for Condor v7.1.3 and later)?: (y/n) [y] <b>y</b>

For security reasons, we want to whitelist all the frontends that we will be serving.
Each frontend should be segregated to its own (set of) username(s).
If you do not want privilege separation, you can still just use the factory user.

Please list the frontends you will be serving:

Frontend security name (leave empty when finished): <b>vofrontend1</b>
Frontend identity (like vo1@gfactory1.my.org): <b>frontenduser1@gfactory1.my.org</b>
Frontend proxy security class: [frontend]
Username: <b>frontenduser1</b>

Frontend security name (leave empty when finished): <b>vofrontend2</b>
Frontend identity (like vo1@gfactory1.my.org): <b>frontenduser2@gfactory1.my.org</b>
Frontend proxy security class: [frontend]
Username: <b>frontenduser2</b>

Frontend security name (leave empty when finished):
Do you want to create the glidein (as opposed to just the config file)?: (y/n) [n]<b>n</b>
To create the glidein, you need to run
/home/gfactory/glideinWMS/creation/create_glidein /home/gfactory/glideinsubmit/glidein_v1_0.cfg/glideinWMS.xml

Configuration files are located in /home/gfactory/glideinsubmit/glidein_v1_0.cfg

</pre>

<p><font face="Liberation Serif"><font size="3">If you followed the example
above, you ended up with a configuration file in </font></font><font
face="Liberation Serif"><font
size="3"><b>/home/gfactory/glideinsubmit/glidein_v1_0.cfg/glideinWMS.xml</b></font></font><font
face="Liberation Serif"><font size="3">. Edit this file to suit your needs
and than create the factory instance as described in the Manual configuration
section below.</font></font></p>

<p><font face="Liberation Serif"><font size="3">At this point you can start
the factory with</font></font></p>

<blockquote>
  <font face="Liberation Serif"><font size="3"><i>&lt;install
  dir&gt;/</i>factory_startup start</font></font></blockquote>

<p><font face="Liberation Serif"><font size="3">where the <i>&lt;install
dir&gt;</i> is the one written out by the installation
script.</font></font></p>

<p><font face="Liberation Serif"><font size="3">To stop the factory the
factory, use</font></font></p>

<blockquote>
  <font face="Liberation Serif"><font size="3"><i>&lt;install
  dir&gt;</i>/factory_startup stop</font></font></blockquote>

<h3><a name="factory_manual"><font face="Verdana"><font size="3">6.1 Manual
configuration</font></font></a></h3>

<p><font face="Liberation Serif"><font size="3">The glidein factory can also
be configured manually.<br>
The complete guide can be found in the <a
href="../manual/factory/entry.html">glideinWMS documentation</a>, but in <a
href="example-config/glide-factory/config_v1.xml">example-config/glide-factory/config_v1.xml</a>
you can find a working example.</font></font></p>

<p><font face="Liberation Serif"><font size="3">Once a configuration file is
ready, you can create the glidein Factory by executing</font></font></p>

<blockquote>
  <font face="Liberation Serif"><font size="3">cd glideinWMS/creation<br>
  ./create_glidein <i>&lt;config file&gt;</i></font></font></blockquote>

<p><font face="Liberation Serif"><font size="3">The startup procedure is the
same as described above.</font></font></p>

<h3><a name="factory_update">6.2 Changing the factory configuration</a></h3>

<p>Occasionally, you may need to change the glidein Factory configuration.
This is done by updating the configuration file and reconfiguring.<br>
<b>Warning:</b> Never update the <i>&lt;install dir&gt;</i>/glideinWMS.xml
file! Either use the configuration file you used to install it, or make a
copy of the glideinWMS.xml file and modify that one.</p>

<p><font face="Liberation Serif"><font size="3">Once you are done editing the
work config file, reconfigure the factory with</font></font></p>

<blockquote>
  <font face="Liberation Serif"><font size="3"><i>&lt;install
  dir&gt;/</i>factory_startup reconfig <i>&lt;work
  config&gt;</i></font></font></blockquote>

<p><font face="Liberation Serif"><font size="3">If the factory was running,
the procedure will stop the factory before reconfiguring it, and restart it
afterwards.</font></font></p>

<h2><a name="monitoring"><font face="Bitstream Vera Serif"><font size="4">7.
Glidein Factory monitoring </font></font> </a></h2>

<p><font face="Liberation Serif"><font size="3">There are several ways to
monitor the entry points of the glidein factory:</font></font></p>
<ul>
  <li><p><font face="Liberation Serif"><font size="3"><a
    href="#monitoring_web">Using the Web monitoring</a></font></font></p>
  </li>
  <li><p><font face="Liberation Serif"><font size="3"><a
    href="#monitoring_tools">Using the WMS tools</a></font></font></p>
  </li>
  <li><p><font face="Liberation Serif"><font size="3"><a
    href="#monitoring_logs">Looking at the glidein factory log
    files</a></font></font> </p>
  </li>
  <li><p><font face="Liberation Serif"><font size="3"><a
    href="#monitoring_glideins">Looking at the glidein
    outputs</a></font></font> </p>
  </li>
  <li><p><font face="Liberation Serif"><font size="3"><a
    href="#monitoring_condor">Checking the WMS collector
    ads</a></font></font></p>
  </li>
</ul>

<h3><a name="monitoring_web"><font face="Verdana"><font size="3">7.1 Glidein
factory entry Web monitoring</font></font></a></h3>

<p><font face="Liberation Serif"><font size="3">You can either monitor the
factory as a whole, or just a single entry point.<br>
<br>
The factory monitoring is located at a URL like the one
below</font></font></p>

<blockquote>
  <font face="Liberation Serif"><font
  size="3">http://gfactory1.my.org/glidefactory/monitor/glidein_v1_0/</font></font></blockquote>

<p><font face="Liberation Serif"><font size="3">Moreover, each entry point,
has its own history on the Web.<br>
<br>
Assuming you have a SanDiego entry, it can be monitored at</font></font></p>

<blockquote>
  <font face="Liberation Serif"><font
  size="3">http://gfactory1.my.org/glidefactory/monitor/glidein_v1_0/entry_SanDiego/</font></font></blockquote>

<h3><a name="monitoring_tools"><font face="Verdana"><font size="3">7.2
Glidein factory monitoring via WMS tools</font></font></a></h3>

<p><font face="Liberation Serif"><font size="3">You can get the equivalent of
the Web page snaphot by using </font></font> </p>

<blockquote>
  <font face="Liberation Serif"><font size="3">cd glideinWMS/tools/<br>
  python wmsXMLView.py</font></font></blockquote>

<h3><a name="monitoring_logs"><font face="Verdana"><font size="3">7.3 Glidein
factory entry log files </font></font> </a></h3>

<p><font face="Liberation Serif"><font size="3">The glidein factory writes
two log files per entry point <b>factory_info.YYYYMMDD.log</b> and
<b>factory_err.YYYYMMDD.log</b>.<br>
<br>
Assuming you have a SanDiego entry, the log files are in</font></font></p>

<blockquote>
  <font face="Liberation Serif"><font
  size="3">/home/gfactory/glidein_submit/glidein_v1_0/entry_SanDiego/log</font></font></blockquote>

<p><font face="Liberation Serif"><font size="3">All errors are reported in
the <b>factory_err.YYYYMMDD.log</b>. file, while <b>factory_info.YYYYMMDD.log
</b>contains entries about what the factory is doing.</font></font></p>

<h3><a name="monitoring_glideins"><font face="Verdana"><font size="3">7.4
Glidein output </font></font> </a></h3>

<p><font face="Liberation Serif"><font size="3">Each glidein creates 2 files
on exit; job.<b>ID</b>.out and job.<b>ID</b>.err.<br>
<br>
Assuming you have a SanDiego entries, the log files are in</font></font></p>

<blockquote>
  <font face="Liberation Serif"><font
  size="3">/home/gfactory/glidein_submit/glidein_v1_0/entry_SanDiego/log</font></font></blockquote>

<p><font face="Liberation Serif"><font size="3">Problems are usually
reasonably easy to spot.</font></font></p>

<h3><a name="monitoring_condor"><font face="Verdana"><font size="3">7.5
Glidein factory ClassAds in the WMS Collector </font></font> </a></h3>

<p><font face="Liberation Serif"><font size="3">The glidein factory also
advertises summary information in the WMS collector.<br>
<br>
Use <b>condor_status</b>:</font></font></p>

<blockquote>
  <font face="Liberation Serif"><font size="3">condor_status
  -any</font></font></blockquote>

<p><font face="Liberation Serif"><font size="3">and look for
<b>glidefactory</b> and <b>glidefactoryclient</b> ads.</font></font></p>

<br>
<p><font face="Liberation Serif" size="3"><a href="index.html">Back to
the index</a>
</font>
</p>
<hr><P ALIGN=LEFT><b>glideinWMS support:</b> glideinwms-support@fnal.gov</p>
</body>
</html>
